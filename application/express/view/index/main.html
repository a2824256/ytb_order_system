<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="http://i.gtimg.cn/vipstyle/frozenui/2.0.0/css/frozen.css">
    <title>Title</title>
</head>
<body style="background-size:cover;font-size: 16px;color: #fff;">
<div style="width: 100%;height: 40px;background: black;color: #fff;text-align: center;line-height: 40px;">订单</div>
<div style="background: white">
    <div class=" ">
        <div class=" " style="margin-bottom: 400px">
            {volist name="list" id="vo"}
            <table width="100%" style="text-align: left">
                <tr style="border:1px solid #afafaf;">
                    <td height="40px">
                        <h4 style="color: #666666">订单号:{$vo.order_number}</h4>
                    </td>
                </tr>
                <tr style="border:1px solid #afafaf;">
                    <td height="40px">
                        <h4 style="color: #666666">姓名:{$vo.user_name}</h4>
                    </td>
                </tr>
                <tr style="border:1px solid #afafaf;">
                    <td height="40px">
                        <h4 style="color: #666666">手机:{$vo.user_telephone}</h4>
                    </td>
                </tr>
                <tr style="border:1px solid #afafaf;">
                    <td height="40px">
                        <h4 style="color: #666666">地址:{$vo.user_address}</h4>
                    </td>
                </tr>
                <tr style="border:1px solid #afafaf;">
                    <td height="40px">
                        <h4 style="color: #666666">邮编:{$vo.user_post_code}</h4>
                    </td>
                </tr>
                <tr style="border:1px solid #afafaf;">
                    <td height="40px">
                        <h4 style="color: #666666">时间:{$vo.create_time}</h4>
                    </td>
                </tr>
                <tr id="del_{$vo.oid}">
                    <td>
                        <input type="hidden" value="{$vo.step}" id="step_{$vo.oid}" />
                        {eq name="$vo.step" value="1" }
                        <button class="ui-btn-lg ui-btn-primary btn_{$vo.oid}" onclick="jump('{$vo.oid}')">取 餐</button>
                        {/eq}
                        {eq name="$vo.step" value="3" }
                        <button class="ui-btn-lg ui-btn-primary btn_{$vo.oid}" onclick="jump('{$vo.oid}')">送 达</button>
                        {/eq}
                    </td>
                </tr>
            </table>
            {/volist}
            {$list->render()}
        </div>
    </div>
</div>
<script src="__STATIC__/js/jquery.min.js" ></script>
<script>
    var url = "{:url('express/Form/updateOrder')}";
    function jump(id) {
        var step = $('#step_'+id).val();
        $.ajax({
            type: "POST",
            url:  url,
            data: {id:id,step:step},// 你的formid
            async: false,
            success: function(result) {
                console.log(result);
                if(result.errcode == 0){
                    $('#step_'+id).val(result.data);
                    if(result.data == 3){
                        $('.btn_'+id).html('送 达');
                    }else{
                        $('#del_'+id).empty();
                    }
                }else{
                    alert(result.errmsg);
                }
            }
        });
    }
</script>
</body>
</html>